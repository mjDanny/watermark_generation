# Удаление водяных знаков с изображений с помощью сверточного автокодировщика

![Пример работы модели](URL_вашего_изображения_с_результатами) <!-- Если есть изображение с результатами -->

Этот проект представляет собой реализацию сверточного автокодировщика на основе Keras, который обучается удалять водяные знаки с изображений. Модель принимает на вход изображения с водяными знаками и восстанавливает их до оригинального состояния.

## Оглавление

- [Описание проекта](#описание-проекта)
- [Установка и запуск](#установка-и-запуск)
- [Использование](#использование)
- [Архитектура модели](#архитектура-модели)
- [Технологии](#технологии)

## Описание проекта

Проект использует сверточный автокодировщик для удаления водяных знаков с изображений. Основные этапы работы:
1. Загрузка и предобработка изображений.
2. Наложение водяных знаков на изображения.
3. Обучение модели на изображениях с водяными знаками и без них.
4. Восстановление изображений с удалением водяных знаков.

Модель обучается на наборе данных, состоящем из изображений с водяными знаками и их оригинальных версий.

## Установка и запуск

Для запуска проекта необходимо установить следующие зависимости:

```bash
!pip install numpy opencv-python matplotlib scikit-learn tensorflow
```

После установки зависимостей скачайте данные:

```bash
wget https://storage.yandexcloud.net/academy.ai/watermarked.zip
unzip -qo "watermarked.zip" -d ./watermarked
```

## Использование

1. Загрузите данные и настройте пути к папкам с изображениями.
2. Обучите модель с помощью функции `autoencoder.fit()`.
3. Используйте обученную модель для удаления водяных знаков с новых изображений.

Пример использования:

```python
# Загрузка изображений
X_train = load_images_from_folder(train_no_wm_path, limit=500)
X_valid = load_images_from_folder(valid_no_wm_path, limit=100)

# Обучение модели
history = autoencoder.fit(X_train_wm, X_train, epochs=10, batch_size=32, validation_split=0.2, verbose=1)

# Предсказание
predicted = autoencoder.predict(X_test_wm)
```

## Архитектура модели

Модель состоит из двух частей:
- **Кодировщик**: Сверточные слои и слои подвыборки (MaxPooling).
- **Декодировщик**: Сверточные слои и слои повышения разрешения (UpSampling).

```plaintext
Model: "functional_3"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer_3 (InputLayer)           │ (None, 128, 128, 3)         │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv2d_15 (Conv2D)                   │ (None, 128, 128, 32)        │             896 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling2d_6 (MaxPooling2D)       │ (None, 64, 64, 32)          │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv2d_16 (Conv2D)                   │ (None, 64, 64, 64)          │          18,496 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling2d_7 (MaxPooling2D)       │ (None, 32, 32, 64)          │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv2d_17 (Conv2D)                   │ (None, 32, 32, 64)          │          36,928 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ up_sampling2d_6 (UpSampling2D)       │ (None, 64, 64, 64)          │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv2d_18 (Conv2D)                   │ (None, 64, 64, 32)          │          18,464 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ up_sampling2d_7 (UpSampling2D)       │ (None, 128, 128, 32)        │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv2d_19 (Conv2D)                   │ (None, 128, 128, 3)         │             867 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
```

## Технологии

- **Python**
- **Keras** и **TensorFlow** для построения и обучения модели.
- **OpenCV** для работы с изображениями.
- **Matplotlib** для визуализации результатов.
- **Scikit-learn** для разделения данных.
